
RewriteEngine On

# Redirect to index.html if file doesn't exist (except for admin directory)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/admin/ [NC]
RewriteRule ^([^\.]+)$ $1.html [NC,L]

# Allow direct access to PHP files in admin directory
RewriteCond %{REQUEST_URI} ^/admin/.*\.php [NC]
RewriteRule ^ - [L]

# Admin panel special handling for non-PHP URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/admin/([^\.]+)$ [NC]
RewriteRule ^admin/([^\.]+)$ admin/$1.php [NC,L]

# Prevent direct access to PHP files (except API and admin)
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteCond %{REQUEST_URI} !^/api/ [NC]
RewriteCond %{REQUEST_URI} !^/admin/ [NC]
RewriteRule ^ %1 [R=301,L]

# Set UTF-8 charset
AddDefaultCharset UTF-8

# Enable CORS
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
</IfModule>

# Prevent directory listing
Options -Indexes

# Error pages
ErrorDocument 404 /index.html

# PHP settings
<IfModule mod_php7.c>
    php_flag display_errors On
    php_value max_execution_time 300
    php_value max_input_time 300
    php_value memory_limit 256M
    php_value post_max_size 32M
    php_value upload_max_filesize 32M
</IfModule>
